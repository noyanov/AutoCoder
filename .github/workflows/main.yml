name: Auto Create Pull Request

on:
  workflow_dispatch:
  push:
    branches:
      - main

permissions:
  contents: write
  pull-requests: write

jobs:
  create-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Make a change
        run: |
          echo "Automated update $(date)" >> generated.txt

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: "autocoder-branch-2"
          commit-message: "chore: automated update"
          title: "chore: automated update"
          body: |
            This pull request was created automatically by **github-actions[bot]**.
          base: main






# name: AutoCoder Workflow
# on:
#   issues:
#     types: [opened, reopened, labeled]
#   workflow_dispatch:

# permissions:
#   contents: write
#   pull-requests: write

# jobs:

#   label_issues:
#     runs-on: ubuntu-latest
#     permissions:
#       issues: write
#     steps:
#       - run: gh issue edit "$NUMBER" --add-label "$LABELS"
#         env:
#           GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#           GH_REPO: ${{ github.repository }}
#           NUMBER: ${{ github.event.issue.number }}
#           LABELS: autocoder-bot

#   generate_code:
#     # Run this job only if the issue has or was given the label 'autocoder-bot'
#     # if: contains(github.event.issue.labels.*.name, 'autocoder-bot')
#     runs-on: ubuntu-latest
#     permissions:
#       contents: write
#       pull-requests: write
  
#     steps:
#       - name: Checkout Repository
#         uses: actions/checkout@v3

#       - name: Configure Git
#         run: |
#           git config --local user.name "autocoder-bot"
#           git config --local user.email "actions@github.com"

#       - name: Set up Environment
#         run: sudo apt-get update && sudo apt-get install -y jq curl

#       - name: Make script executable
#         run: chmod +x ./scripts/script.sh

#       - name: Generate Code with ChatGPT
#         id: generate_code
#         env:
#           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#           REPOSITORY: ${{ github.repository }}
#           ISSUE_NUMBER: ${{ github.event.issue.number }}
#           OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
#         run: ./scripts/script.sh $GITHUB_TOKEN $REPOSITORY $ISSUE_NUMBER $OPENAI_API_KEY
#         # run: |
#         #   ./scripts/script.sh "${{ env.GITHUB_TOKEN }}" "${{ env.REPOSITORY }}" "${{ env.ISSUE_NUMBER }}" "${{ env.OPENAI_API_KEY }}"

#       - name: Upload Artifact
#         uses: actions/upload-artifact@v4
#         with:
#           name: autocoder-artifact
#           path: autocoder-bot/

#       - name: Download Artifact
#         uses: actions/download-artifact@v4
#         with:
#           name: autocoder-artifact
#           path: autocoder-artifact/

#       - name: Display Generated Code using the ls command
#         run: ls -R ./autocoder-artifact

#       - name: Commit Changes
#         run: |
#           git config user.name "autocoder-bot"
#           git config user.email "actions@github.com"
#           git add ./autocoder-artifact
#           git commit -m "Add generated code from ChatGPT"

#       - name: Create Pull Request
#         uses: peter-evans/create-pull-request@v6
#         with:
#           # token: ${{ secrets.PERSONAL_TOKEN }}  # Try to use own token
#           token: ${{ secrets.GITHUB_TOKEN }}
#           labels: "autocoder-bot"
#           committer: "autocoder-bot <actions@github.com>"
#           # author: "autocoder-bot <actions@github.com>"
#           author: github-actions[bot] <actions@github.com>
#           title: "#${{ github.event.issue.number }}"
#           branch: autocoder-branch-${{ github.event.issue.number }}
  